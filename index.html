<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>🧠 Blang 中文互動語法實驗室</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        font-family: 'Noto Sans TC', sans-serif;
        margin: 2em;
        background: #fdfdfd;
        color: #333;
      }
      input,
      button,
      textarea {
        font-size: 1.1em;
        padding: 0.4em 0.6em;
        margin-top: 0.5em;
      }
      #結果區,
      #轉譯結果區,
      #console_log {
        margin-top: 1.2em;
        font-weight: bold;
      }
      #console_log {
        background: #f3f3f3;
        padding: 1em;
        white-space: pre-wrap;
        color: #cc0000;
      }
      .區塊 {
        margin-bottom: 2em;
      }
      .undeclared {
        background: yellow;
      }
    </style>
  </head>
  <body>
    <h2>🧪 Blang 中文語法測試平台</h2>

    <div class="區塊">
      <label for="input">請輸入語句：</label><br />
      <input id="input" list="語法選單" placeholder="例如：顯示(名字)" />
      <datalist id="語法選單">
        <option value="顯示(名字)"></option>
        <option value="建立清單(水果們)"></option>
        <option value="加入項目(水果們, '香蕉')"></option>
      </datalist>

      <button id="submit">執行語句</button>
    </div>

    <div class="區塊">
      <div>🔎 原始語句：</div>
      <div id="原始語句區"></div>
    </div>

    <div class="區塊">
      <div>🧾 轉譯結果：</div>
      <div id="轉譯結果區"></div>
    </div>

    <div class="區塊">
      <div>📤 執行結果：</div>
      <div id="結果區"></div>
    </div>

    <div class="區塊">
      <div>⚠️ 錯誤訊息：</div>
      <div id="console_log"></div>
    </div>

    <!-- 模組載入順序建議：先載 array，再載核心邏輯 -->
    <script src="blang-modules/array.js"></script>
    <script src="errorHelper.js"></script>
    <script src="dist/blangSyntaxAPI.browser.js"></script>
    <script src="dist/semanticHandler.browser.js"></script>
    <script src="variableHints.js"></script>
    <script src="parser.js"></script>

    <script>
      console.log(parseBlang('顯示("你好")'));
      document.getElementById('submit').addEventListener('click', () => {
        const input = document.getElementById('input').value;
        const { highlighted, message } = variableHints.getHints(input);
        document.getElementById('原始語句區').innerHTML = highlighted;
        if (message) document.getElementById('console_log').innerText = message;

        try {
          console.log('輸入語句：', input);
          const jsCode = parseBlang(input); // 由 parser.js 提供
          console.log('轉譯結果：', jsCode);
          document.getElementById('轉譯結果區').innerText = jsCode;

          const result = handleSyntax(jsCode); // 假設 semanticHandler 處理結果
          console.log('執行結果：', result);
          document.getElementById('結果區').innerText = result ?? '✅ 執行成功';
          if (!message) document.getElementById('console_log').innerText = '';
        } catch (e) {
          document.getElementById('console_log').innerText = e.message;
        }
      });
    </script>
  </body>
</html>
