<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>ğŸ§  Blang ä¸­æ–‡äº’å‹•èªæ³•å¯¦é©—å®¤</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        font-family: 'Noto Sans TC', sans-serif;
        margin: 2em;
        background: #fdfdfd;
        color: #333;
      }
      input,
      button,
      textarea {
        font-size: 1.1em;
        padding: 0.4em 0.6em;
        margin-top: 0.5em;
      }
      #çµæœå€,
      #è½‰è­¯çµæœå€,
      #console_log {
        margin-top: 1.2em;
        font-weight: bold;
      }
      #console_log {
        background: #f3f3f3;
        padding: 1em;
        white-space: pre-wrap;
        color: #cc0000;
      }
      .å€å¡Š {
        margin-bottom: 2em;
      }
      .undeclared {
        background: yellow;
      }
    </style>
  </head>
  <body>
    <h2>ğŸ§ª Blang ä¸­æ–‡èªæ³•æ¸¬è©¦å¹³å°</h2>

    <div class="å€å¡Š">
      <label for="input">è«‹è¼¸å…¥èªå¥ï¼š</label><br />
      <input id="input" list="èªæ³•é¸å–®" placeholder="ä¾‹å¦‚ï¼šé¡¯ç¤º(åå­—)" />
      <datalist id="èªæ³•é¸å–®">
        <option value="é¡¯ç¤º(åå­—)"></option>
        <option value="å»ºç«‹æ¸…å–®(æ°´æœå€‘)"></option>
        <option value="åŠ å…¥é …ç›®(æ°´æœå€‘, 'é¦™è•‰')"></option>
      </datalist>

      <button id="submit">åŸ·è¡Œèªå¥</button>
    </div>

    <div class="å€å¡Š">
      <div>ğŸ“ ç¯„ä¾‹èªå¥ï¼ˆå¯ç›´æ¥è¤‡è£½ï¼‰ï¼š</div>
      <pre>
é¡¯ç¤º("ä½ å¥½")
å»ºç«‹æ¸…å–®(æ¸…å–®)
åŠ å…¥é …ç›®(æ¸…å–®, "è˜‹æœ")
è‹¥ (1 > 0) å‰‡ é¡¯ç¤º("yes") å¦å‰‡ é¡¯ç¤º("no")
      </pre>
      <div>
        è©³ç´°èªæ³•æ•™å­¸è«‹è¦‹
        <a href="README.md" target="_blank">README</a>
      </div>
    </div>

    <div class="å€å¡Š">
      <div>ğŸ” åŸå§‹èªå¥ï¼š</div>
      <div id="åŸå§‹èªå¥å€"></div>
    </div>

    <div class="å€å¡Š">
      <div>ğŸ§¾ è½‰è­¯çµæœï¼š</div>
      <div id="è½‰è­¯çµæœå€"></div>
    </div>

    <div class="å€å¡Š">
      <div>ğŸ“¤ åŸ·è¡Œçµæœï¼š</div>
      <div id="çµæœå€"></div>
    </div>

    <div class="å€å¡Š">
      <div>âš ï¸ éŒ¯èª¤è¨Šæ¯ï¼š</div>
      <div id="console_log"></div>
    </div>

    <!-- æ¨¡çµ„è¼‰å…¥é †åºå»ºè­°ï¼šå…ˆè¼‰ arrayï¼Œå†è¼‰æ ¸å¿ƒé‚è¼¯ -->
    <script src="blang-modules/array.js"></script>
    <script src="errorHelper.js"></script>
    <script src="dist/blangSyntaxAPI.browser.js?v=1"></script>
    <script src="dist/semanticHandler.browser.js?v=1"></script>
    <script src="variableHints.js"></script>
    <script src="parser.js"></script>

    <script>
      console.log(parseBlang('é¡¯ç¤º("ä½ å¥½")'));
      document.getElementById('submit').addEventListener('click', () => {
        const input = document.getElementById('input').value;
        const { highlighted, message } = variableHints.getHints(input);
        document.getElementById('åŸå§‹èªå¥å€').innerHTML = highlighted;
        if (message) document.getElementById('console_log').innerText = message;

        try {
          console.log('è¼¸å…¥èªå¥ï¼š', input);
          const jsCode = parseBlang(input); // ç”± parser.js æä¾›
          console.log('è½‰è­¯çµæœï¼š', jsCode);
          document.getElementById('è½‰è­¯çµæœå€').innerText = jsCode;

          const result = handleSyntax(jsCode); // å‡è¨­ semanticHandler è™•ç†çµæœ
          console.log('åŸ·è¡Œçµæœï¼š', result);
          document.getElementById('çµæœå€').innerText = result ?? 'âœ… åŸ·è¡ŒæˆåŠŸ';
          if (!message) document.getElementById('console_log').innerText = '';
        } catch (e) {
          const msg = e && e.message ? e.message : String(e);
          if (msg.includes('ç„¡æ³•è¾¨è­˜èªå¥')) {
            console.warn('ç„¡æ³•è§£æèªå¥ï¼š', input);
            document.getElementById('console_log').innerText =
              'âš ï¸ ç„¡æ³•è¾¨è­˜èªå¥ï¼Œè«‹ç¢ºèªèªæ³•æ­£ç¢ºæˆ–åƒè€ƒèªå¥ç¯„ä¾‹ã€‚';
          } else {
            document.getElementById('console_log').innerText = msg;
          }
        }
      });
    </script>
  </body>
</html>
